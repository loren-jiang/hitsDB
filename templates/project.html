{% extends 'base.html' %}
{% load static %}

{% block content %}

<!-- The Modal -->
<div class="modal fade" id="newExp">
  
  <div class="modal-dialog">
    <div class="modal-content">
    
      <!-- Modal Header -->
      <div class="modal-header">
        <h4 class="modal-title">New Experiment</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      
      <!-- Modal body -->
      <div class="modal-body">
        <form method="post" >
          {% csrf_token %}
          {% include 'bs4_form.html' with form=form %}
          <input type="submit" value="Create" />
        </form>
      </div>
      
      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
      </div>
      
    </div>
  </div>
</div>

<div class="container-fluid">
    <div class="row">
        <div class="col-md-6">
            <div class="jumbotron">
                <h3>Experiments <img src={% static 'icons/atomic.png' %} height="10%" width="10%"> </h3>

                  {% load django_tables2 %} 
                  {% render_table experimentsTable %}
                  <!-- Button to Open the Modal -->
                  <button type="button" class="btn btn-info" data-toggle="modal" data-target="#newExp">
                      New Experiment
                  </button>
                  <!--<a class="btn btn-info" role="button" href={% url 'new_proj_experiment' pk_proj %}> New Experiment </a>-->
                  <a  class="btn btn-info" role="button" id="delete-exps"> Delete Selected </a>
                  {# <a  onclick="return deleteSelExps()" class="btn btn-info" role="button" id="delete-exps" href={% url 'delete_proj_exps' pk_proj '0/'  %}> Delete Selected </a> #}
            </div>
        </div>
        <div class="col-md-6">
            <div class="jumbotron">
                  <h3>Libraries <img src={% static 'icons/book.png' %} height="10%" width="10%"></h3>
                  {% load django_tables2 %} 
                  {% render_table librariesTable %}
                  <a class="btn btn-info" role="button" href={% url 'proj_libs' pk_proj %}>View all libraries</a>
            </div>
        </div>

        <div class="col-md-6">
            <div class="jumbotron">
                <h3>Collaborators <img src={% static 'icons/users.png' %} height="10%" width="10%"> </h3>

                  {% load django_tables2 %} 
                  {% render_table collaboratorsTable %}
                  <!-- Button to Open the Modal -->
                  <button type="button" class="btn btn-info" data-toggle="modal" data-target="#newExp">
                      New Experiment
                  </button>
                  <!--<a class="btn btn-info" role="button" href={% url 'new_proj_experiment' pk_proj %}> New Experiment </a>-->
                  <a  class="btn btn-info" role="button" id="delete-exps"> Delete Selected </a>
                  {# <a  onclick="return deleteSelExps()" class="btn btn-info" role="button" id="delete-exps" href={% url 'delete_proj_exps' pk_proj '0/'  %}> Delete Selected </a> #}
            </div>
        </div>
 
    </div>  
</div>



<script>
  $(document).ready(function() {
       
    function getSelected() {
      var selected = [];
                $.each($("td input[type='checkbox']:checked"), function(){
                    var exp = $(this).val();     
                    if (exp.length > 0)  {selected.push(exp);}   
                });
      return selected;
    }

    $("#delete-exps").on("click",function(e){
      
      selected = getSelected();
      e.preventDefault();
      var newurl = '/proj/{{pk_proj}}/delete_exps/' + selected.join("/");
      if (selected.length > 0) {
        if (confirm("Are you sure you want to delete these experiments?")) {
          // $("#delete-exps").prop("href", newurl);
          console.log(newurl);
          window.location.href = newurl;
        } 
        else {
          // $("#delete-exps").prop("href", '/proj/{{pk_proj}}');
        }
      } 
      
    });
            
  });

</script>

{% endblock %}